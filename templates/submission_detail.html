{% extends 'base.html' %}

{% block head %}
<title>Submission Details</title>
{% endblock %}

{% block body %}
<header class="site-header">
  <div class="page-frame">
    <nav class="site-nav">
      <a href="{{ url_for('home') }}" class="logo">CityU Tracker</a>
      <ul class="nav-links">
        <li><a href="{{ url_for('home') }}" class="{{ 'active' if current == 'home' else '' }}">Home</a></li>
        <li><a href="{{ url_for('tracker') }}" class="{{ 'active' if current == 'tracker' else '' }}">Tracker</a></li>
        {% if current_user.is_authenticated %}
          <li><a href="{{ url_for('profile') }}" class="{{ 'active' if current == 'profile' else '' }}">Profile</a></li>
        {% endif %}
        <li><a href="{{ url_for('about') }}" class="{{ 'active' if current == 'about' else '' }}">About</a></li>
        {% if current_user.is_authenticated %}
          <li><a href="{{ url_for('logout') }}">Log Out</a></li>
        {% else %}
          <li><a href="{{ url_for('login') }}" class="{{ 'active' if current == 'login' else '' }}">Log In</a></li>
          <li><a href="{{ url_for('register') }}" class="{{ 'active' if current == 'register' else '' }}">Register</a></li>
        {% endif %}
      </ul>
    </nav>
  </div>
</header>

<main class="site-main">
  <div class="page-frame">
    <div class="card p-4">
      {% set faculty_labels = {
        "business": "Business",
        "data_science": "Data Science",
        "finance": "Finance",
        "humanities_social_sciences": "Humanities and Social Sciences",
        "health_wellness": "Health and Wellness",
        "innovation_design": "Inovation and Design",
        "international_tourism_management": "International Tourism and Managment",
        "education": "Education",
        "law": "Law"
      } %}
      {% set region_labels = {
        "hk": "HK",
        "singapore": "Singapore",
        "uk": "United Kingdom",
        "europe": "Europe",
        "us_canada": "United States & Canada",
        "australia": "Australia"
      } %}
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
          <h2 class="page-title mb-1">{{ submission.school }}</h2>
          <div class="text-muted">{{ submission.program }}</div>
        </div>
        <span class="status-badge status-{{ submission.status }}">{{ submission.status|upper }}</span>
      </div>

      <div class="stats-container mb-3">
        <div class="stat-item">
          <span class="stat-label">Faculty</span>
          <span class="stat-value">
            {{ faculty_labels.get(submission.faculty, submission.faculty)|upper if submission.faculty else "—" }}
          </span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Region</span>
          <span class="stat-value">
            {{ region_labels.get(submission.region, submission.region)|upper if submission.region else "—" }}
          </span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Submitted</span>
          <span class="stat-value">
            {% if submission.submission_date %}
              {{ submission.submission_date.strftime("%b %d, %Y") }}
            {% else %}
              —
            {% endif %}
          </span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Result</span>
          <span class="stat-value">
            {% if submission.result_date %}
              {{ submission.result_date.strftime("%b %d, %Y") }}
            {% else %}
              —
            {% endif %}
          </span>
        </div>
      </div>

      <hr class="my-3">

      <div class="row g-3">
        <div class="col-md-6">
          <h6 class="mb-2">GPA</h6>
          <div class="text-muted">{{ submission.gpa if submission.gpa is not none else "—" }}</div>
        </div>
        <div class="col-md-6">
          <h6 class="mb-2">GRE</h6>
          <div class="text-muted">
            {% if submission.gre_total or submission.gre_q or submission.gre_v or submission.gre_awa %}
              Total {{ submission.gre_total if submission.gre_total is not none else "—" }},
              Q {{ submission.gre_q if submission.gre_q is not none else "—" }},
              V {{ submission.gre_v if submission.gre_v is not none else "—" }},
              AWA {{ submission.gre_awa if submission.gre_awa is not none else "—" }}
            {% else %}
              —
            {% endif %}
          </div>
        </div>
        <div class="col-md-6">
          <h6 class="mb-2">GMAT</h6>
          <div class="text-muted">
            {% if submission.gmat_total or submission.gmat_q or submission.gmat_v or submission.gmat_di %}
              Total {{ submission.gmat_total if submission.gmat_total is not none else "—" }},
              Q {{ submission.gmat_q if submission.gmat_q is not none else "—" }},
              V {{ submission.gmat_v if submission.gmat_v is not none else "—" }},
              DI {{ submission.gmat_di if submission.gmat_di is not none else "—" }}
            {% else %}
              —
            {% endif %}
          </div>
        </div>
        <div class="col-md-6">
          <h6 class="mb-2">IELTS</h6>
          <div class="text-muted">
            {% if submission.ielts_total or submission.ielts_l or submission.ielts_r or submission.ielts_w or submission.ielts_s %}
              Overall {{ submission.ielts_total if submission.ielts_total is not none else "—" }},
              L {{ submission.ielts_l if submission.ielts_l is not none else "—" }},
              R {{ submission.ielts_r if submission.ielts_r is not none else "—" }},
              W {{ submission.ielts_w if submission.ielts_w is not none else "—" }},
              S {{ submission.ielts_s if submission.ielts_s is not none else "—" }}
            {% else %}
              —
            {% endif %}
          </div>
        </div>
        <div class="col-md-6">
          <h6 class="mb-2">TOEFL</h6>
          <div class="text-muted">
            {% if submission.toefl_total or submission.toefl_l or submission.toefl_r or submission.toefl_s or submission.toefl_w %}
              Total {{ submission.toefl_total if submission.toefl_total is not none else "—" }},
              L {{ submission.toefl_l if submission.toefl_l is not none else "—" }},
              R {{ submission.toefl_r if submission.toefl_r is not none else "—" }},
              S {{ submission.toefl_s if submission.toefl_s is not none else "—" }},
              W {{ submission.toefl_w if submission.toefl_w is not none else "—" }}
            {% else %}
              —
            {% endif %}
          </div>
        </div>
      </div>

      <div class="mt-4">
        <a href="{{ url_for('tracker') }}" class="btn btn-outline-secondary">Back to Tracker</a>
      </div>
    </div>
  </div>
</main>
{% endblock %}
